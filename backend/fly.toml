app = "rllyu-backend"
primary_region = "iad"

[build]

[env]
  PORT         = "3001"
  NODE_ENV     = "production"
  DATABASE_URL = "file:/data/prod.db"
  FRONTEND_URL = "https://rllyu.netlify.app"
  # Set secrets via:
  #   fly secrets set OPENAI_API_KEY=sk-... SESSION_SECRET=...

[http_service]
  internal_port       = 3001
  force_https         = true
  auto_stop_machines  = true
  auto_start_machines = true
  min_machines_running = 0

  [http_service.concurrency]
    type       = "connections"
    hard_limit = 25
    soft_limit = 20

# Persistent volume for SQLite
[[mounts]]
  source      = "rllyu_data"
  destination = "/data"

[[vm]]
  memory = "512mb"
  cpus   = 1
